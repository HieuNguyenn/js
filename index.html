<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>facebook</title>
    <link rel="shortcut icon"
        href="https://2.bp.blogspot.com/-gFsA2g18lWQ/XD-ZejQyrfI/AAAAAAAAG6w/98a75D-YjRYMrg73zZ0UUfqdstQS7YBbwCK4BGAYYCw/s1600/Logo%2BTiktok.png"
        type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="container mt-3">
        <h2 style="text-align: center; color: rgb(3, 9, 10); border-width: 30px; background-color: rgb(227, 209, 217);">
            Quân Đội</h2>
        <hr style="height: 10px; color: rgb(187, 55, 75); background-color: aqua; border-width: 5px;">
        <button style="display: none;" type="button" class="btn btn-primary" data-bs-toggle="modal"
            data-bs-target="#myModal">

        </button>
    </div>

    <!-- The Modal -->
    <div class="modal" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Quân</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <img style="width: 45%; float: left;"
                        src="https://anhdep123.com/wp-content/uploads/2021/01/anh-doremon-cute.jpg" alt="">
                    <h5 id="name"></h5>
                    <p id="dob"></p>
                    <p id="bangluong"></p>
                    <p id="ngayvao"></p>
                    <p id="phongban"></p>
                    <p id="ngaynghi"></p>
                    <p id="lamthem"></p>
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>
    <main id="main"></main>
    <button id="post">Thêm Nhân Viên</button>
    <div id="postnhanvien">
        <input name="Họ và Tên" type="text" placeholder="Họ và Tên" id="name1">
        <input name="Ngày Sinh" type="text" placeholder="Ngày Sinh" id="dob1">
        <input name="Bảng Lương" type="text" placeholder="Bảng Lương" id="bangluong1">
        <input name="Ngày Vào Công Ty" type="text" placeholder="Ngày Vào Công Ty" id="ngayvao1">
        <br>
        <input name="Phòng Ban" type="text" placeholder="Phòng Ban" id="phongban1">
        <input name="Số Ngày Nghỉ Còn Lại" type="text" placeholder="Số Ngày Nghỉ Còn Lại" id="ngaynghi1">
        <input name="Số Ngày Đã Làm Thêm" type="text" placeholder="Số Ngày Đã Làm Thêm" id="lamthem1">
    </div>
    <!-- <button id="PATCH">Thông Tin Nhân Viên</button>
    <div id="pacthnhanvien">
        <input name="id" type="text" placeholder="id" id="id2">
        <input name="Họ và Tên" type="text" placeholder="Họ và Tên" id="name2">
        <input name="Phòng Ban" type="text" placeholder="Phòng Ban" id="phongban2">
    </div> -->

    <script>
        // get danh sách nhân viên
        fetch("http://localhost:8080/staffs")
            .then(function (response) {
                return response.json();
            }).then(function (staffs) {
                // code tạo HTML từ danh sách nhân viên ở đây.
                staffs.forEach((element) => {
                    let data = document.createElement("div");
                    let name = document.createElement("p");
                    let img = document.createElement("img");
                    data.append(name);
                    data.append(img);
                    data.id = element.id;
                    document.getElementById("main");
                    main.append(data);
                    name.innerHTML = element.name;
                    img.setAttribute("src", element.image);
                    data.onclick = nhanvien;
                    data.setAttribute("data-bs-toggle", "modal");
                    data.setAttribute("data-bs-target", "#myModal");
                });
                function nhanvien(event) {
                    staffs.forEach((element) => {
                        if ("" + element.id === this.id) {
                            document.getElementById("name").innerHTML = "Họ và tên: " + element.name;
                            let dob = new Date(element.doB);
                            document.getElementById("dob").innerHTML = "Ngày Sinh: " + dob.toLocaleDateString();
                            let startD = new Date(element.startDate);
                            document.getElementById("ngayvao").innerHTML = "Ngày Vào Công Ty: " + startD.toLocaleDateString();
                            fetch("http://localhost:8080/departments")
                                .then(function (response) {
                                    return response.json();
                                }).then(function (staffs) {
                                    document.getElementById("phongban").innerHTML = "Phòng Ban: " + element.departmentId;
                                    // console.log(element.departmentId);
                                })
                            document.getElementById("ngaynghi").innerHTML = "Số Ngày Nghỉ Còn Lại: " + element.annualLeave;
                            document.getElementById("lamthem").innerHTML = "Số Ngày Đã làm Thêm: " + element.overTime;
                            fetch("http://localhost:8080/staffsSalary")
                                .then(function (response) {
                                    return response.json();
                                }).then(function (staffs) {
                                    document.getElementById("bangluong").innerHTML = "Bảng Lương: " + element.salaryScale;
                                })
                        }
                    })
                }
                let postnv = document.getElementById("post");
                postnv.onclick = postnhanvien
                function postnhanvien() {
                    // Post thêm nhân viên mới
                    let name1 = document.getElementById("name1");
                    console.log(name1.value);
                    let dob1 = document.getElementById("dob1");
                    console.log(dob1.value);
                    let bangluong1 = document.getElementById("bangluong1")
                    console.log(bangluong1.value);
                    let ngayvao1 = document.getElementById("ngayvao1");
                    console.log(ngayvao1.value);
                    let phongban1 = document.getElementById("phongban1");
                    console.log(phongban1.value);
                    let ngaynghi1 = document.getElementById("ngaynghi1");
                    console.log(ngaynghi1.value);
                    let lamthem1 = document.getElementById("lamthem1");
                    console.log(lamthem1.value);
                    let newstaff = {
                        name: name1.value,
                        doB: dob1.value,
                        salaryScale: bangluong1.value,
                        startDate: ngayvao1.value,
                        departmentId: phongban1.value,
                        annualLeave: ngaynghi1.value,
                        overTime: lamthem1.value,
                        image: "https://anhdep123.com/wp-content/uploads/2021/01/anh-doremon-cute.jpg",
                    }
                    fetch("http://localhost:8080/staffs", {
                        method: "POST",
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'

                        },
                        body: JSON.stringify(newstaff)


                    }).then((response) => {
                        console.log(response);
                    });
                }
            //     let patch = document.getElementById("PATCH");
            //     patch.onclick = pacthnhanvien
            //     function pacthnhanvien() {
            //         let id2 = document.getElementById("id2");
            //         console.log(id2.value);
            //         let name2 = document.getElementById("name2");
            //         console.log(name2.value);
            //         let phongban2 = document.getElementById("phongban2");
            //         console.log(phongban2.value);
            //         let updatestaff = {
            //             id: id2.value,
            //             name: name2.value,
            //             departmentId: phongban2.value,
            //         }

            //         // PATCH cập nhật thông tin nhân viên
            //         fetch("http://localhost:8080/staffs", {
            //             method: "PATCH", // bắt buộc viết hoa chữ PATCH
            //             headers: {
            //                 'Accept': 'application/json',
            //                 'Content-Type': 'application/json'
            //             },
            //             body: JSON.stringify(updatestaff)
            //         }).then((response) => {
            //             console.log(response);
            //         });
            //     }
            });


               // console.log("id cua nhan vien la: "+ element.id);
                            // console.log("id cua phan tu da click la: "+ this.id);

                            // if (this.id === "" + element.id) {
                            //     console.log(element.id);
                            //     console.log(this.id);
                            //     console.log("a tim thay roi");
                            // }


                            //    if(this.id === ""+element.id){
                            //     console.log("a tim thay roi");
                            //     console.log(element);
                            //    }
    </script>

</body>

</html>